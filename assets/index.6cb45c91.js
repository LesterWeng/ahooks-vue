var e=Object.assign;import{k as t,l as n,d as r,m as o,n as a,w as l}from"./app.127dcd3e.js";import{u as s}from"./index.c5d935da.js";const i={formatResult:e=>e,requestMethod:function(e){let t,n;return"string"==typeof e?t=e:(t=e.url,n=e),fetch(t,n).then((e=>{if(e.ok)return e.json();throw new Error(e.statusText)}))},manual:!1,onSuccess:()=>{},onError:()=>{},onFinally:()=>{},defaultLoading:!1,loadingDelay:0,pollingInterval:0,pollingWhenHidden:!0,pollingSinceLastFinished:!0,defaultParams:[],debounceInterval:0,loadingWhenDebounceStart:!0,throttleInterval:0,initialData:void 0,throwOnError:!1,refreshDeps:[],refreshOnWindowFocus:!1},u=Symbol("useRequestConfig");function c(c,d={}){var f;let v={};t()&&(v=null!=(f=n(u))?f:{});const h=e(e(e({},i),v),d),{requestMethod:m,defaultLoading:g,manual:p,throwOnError:b,onSuccess:I,onError:w,onFinally:D,formatResult:y,initialData:S,defaultParams:T,loadingDelay:j,debounceInterval:P,loadingWhenDebounceStart:E,throttleInterval:F,pollingInterval:O,pollingWhenHidden:W,pollingSinceLastFinished:L,refreshOnWindowFocus:R,refreshDeps:q}=h;let x;x=["string","object"].includes(typeof c)?()=>m(c):(...e)=>new Promise(((t,n)=>{const r=c(...e);let o=r;if(!r.then){if(!["string","object"].includes(typeof r))throw new Error("If sevice is a function, it must return a String, Object or Promise");o=m(r)}o.then(t).catch(n)}));const k=r(g),H=r(S),M=r(),V=r(T),C=r(T);let z=0,A=!1;t()&&o((()=>{A=!0}));let B,G,J=r(!0);function K(...e){G&&clearTimeout(G),B&&clearTimeout(B),j?B=setTimeout((()=>{k.value=!0}),j):k.value=!0,z++;const t=z;V.value=a.cloneDeep(e);const n=()=>A||t!==z;return x(...e).then((t=>{if(n())return;const r=y(t);return H.value=r,C.value=a.cloneDeep(e),I(r,e),r})).catch((t=>{if(!n()&&(console.error(t),M.value=t,w(t,e),b))throw t})).finally((()=>{n()||(B&&clearTimeout(B),O&&L&&(G=W&&!J.value?setInterval((()=>{W&&!J.value||(clearInterval(G),K(...e))}),O):setTimeout((()=>{K(...e)}),O)),k.value=!1,D())}))}t()&&(J=s({onVisible(){R&&U()}}).isVisible);let N,Q=K;if(P){const e=a.debounce(K,P);Q=(...t)=>(E&&(k.value=!0),Promise.resolve(e(...t)))}if(F){const e=a.throttle(K,F);Q=(...t)=>Promise.resolve(e(...t))}function U(){return Q(...V.value)}return O&&!L&&(Q=(...e)=>(N&&clearInterval(N),N=setInterval((()=>{W&&!J.value||K(...e)}),O),K(...e))),p||Q(...T),l(q,U),{loading:k,error:M,data:H,run:Q,params:V,lastSuccessParams:C,cancel:()=>{N&&clearInterval(N),G&&clearTimeout(G),B&&clearTimeout(B),z++,k.value=!1},refresh:U}}export{u as R,c as u};
