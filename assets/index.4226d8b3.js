var e=Object.defineProperty,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,a=(e,a)=>{for(var l in a||(a={}))r.call(a,l)&&o(e,l,a[l]);if(t)for(var l of t(a))n.call(a,l)&&o(e,l,a[l]);return e};import{g as l,i as s,e as i,f as u,l as c,h as f}from"./app.988e7912.js";import{u as v}from"./index.a2037368.js";const p={formatResult:e=>e,requestMethod:function(e){let t,r;return"string"==typeof e?t=e:(t=e.url,r=e),fetch(t,r).then((e=>{if(e.ok)return e.json();throw new Error(e.statusText)}))},manual:!1,onSuccess:()=>{},onError:()=>{},onFinally:()=>{},defaultLoading:!1,loadingDelay:0,pollingInterval:0,pollingWhenHidden:!0,pollingSinceLastFinished:!0,defaultParams:[],debounceInterval:0,loadingWhenDebounceStart:!0,throttleInterval:0,initialData:void 0,throwOnError:!1,refreshDeps:[],refreshOnWindowFocus:!1},d=Symbol("useRequestConfig");function h(e,t={}){var r;let n={};l()&&(n=null!=(r=s(d))?r:{});const o=a(a(a({},p),n),t),{requestMethod:h,defaultLoading:m,manual:g,throwOnError:b,onSuccess:y,onError:w,onFinally:I,formatResult:O,initialData:j,defaultParams:D,loadingDelay:P,debounceInterval:S,loadingWhenDebounceStart:T,throttleInterval:x,pollingInterval:E,pollingWhenHidden:F,pollingSinceLastFinished:W,refreshOnWindowFocus:L,refreshDeps:R}=o;let q;q=["string","object"].includes(typeof e)?()=>h(e):(...t)=>new Promise(((r,n)=>{const o=e(...t);let a=o;if(!o.then){if(!["string","object"].includes(typeof o))throw new Error("If sevice is a function, it must return a String, Object or Promise");a=h(o)}a.then(r).catch(n)}));const H=i(m),M=i(j),V=i(),k=i(D),C=i(D);let z=0,A=!1;l()&&u((()=>{A=!0}));let B,G,J=i(!0);function K(...e){G&&clearTimeout(G),B&&clearTimeout(B),P?B=setTimeout((()=>{H.value=!0}),P):H.value=!0,z++;const t=z;k.value=c.exports.cloneDeep(e);const r=()=>A||t!==z;return q(...e).then((t=>{if(r())return;const n=O(t);return M.value=n,C.value=c.exports.cloneDeep(e),y(n,e),n})).catch((t=>{if(!r()&&(console.error(t),V.value=t,w(t,e),b))throw t})).finally((()=>{r()||(B&&clearTimeout(B),E&&W&&(G=F&&!J.value?setInterval((()=>{F&&!J.value||(clearInterval(G),K(...e))}),E):setTimeout((()=>{K(...e)}),E)),H.value=!1,I())}))}l()&&(J=v({onVisible(){L&&U()}}).isVisible);let N,Q=K;if(S){const e=c.exports.debounce(K,S);Q=(...t)=>(T&&(H.value=!0),Promise.resolve(e(...t)))}if(x){const e=c.exports.throttle(K,x);Q=(...t)=>Promise.resolve(e(...t))}function U(){return Q(...k.value)}return E&&!W&&(Q=(...e)=>(N&&clearInterval(N),N=setInterval((()=>{F&&!J.value||K(...e)}),E),K(...e))),g||Q(...D),f(R,U),{loading:H,error:V,data:M,run:Q,params:k,lastSuccessParams:C,cancel:()=>{N&&clearInterval(N),G&&clearTimeout(G),B&&clearTimeout(B),z++,H.value=!1},refresh:U}}export{d as R,h as u};
