var e=Object.assign;import{M as t,i as r,u as n,H as o}from"./framework.ce6f7686.js";import"./types.5bcbc827.js";import{u as a}from"./index.1225d805.js";import{r as c,b as u,S as s,i,a as l,d as b}from"./debounce.05bfc31b.js";import{g as f,o as j,i as v,a as p,b as y,c as m,k as d,d as h,e as g,t as w,M as A,f as O,h as S,n as I,j as M,l as P,m as D,p as E,q as x,S as F,r as k}from"./_initCloneObject.47474513.js";import{t as T}from"./throttle.88b7ff20.js";var U=f(c,"WeakMap");var W=j(Object.keys,Object),R=Object.prototype.hasOwnProperty;function V(e){return p(e)?y(e):function(e){if(!v(e))return W(e);var t=[];for(var r in Object(e))R.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)}function B(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}function L(){return[]}var q=Object.prototype.propertyIsEnumerable,C=Object.getOwnPropertySymbols,H=C?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,a=[];++r<n;){var c=e[r];t(c,r,e)&&(a[o++]=c)}return a}(C(e),(function(t){return q.call(e,t)})))}:L;var N=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)B(t,H(e)),e=h(e);return t}:L;function G(e,t,r){var n=t(e);return g(e)?n:B(n,r(e))}function $(e){return G(e,V,H)}function _(e){return G(e,d,N)}var z=f(c,"DataView"),J=f(c,"Promise"),K=f(c,"Set"),Q=w(z),X=w(A),Y=w(J),Z=w(K),ee=w(U),te=u;(z&&"[object DataView]"!=te(new z(new ArrayBuffer(1)))||A&&"[object Map]"!=te(new A)||J&&"[object Promise]"!=te(J.resolve())||K&&"[object Set]"!=te(new K)||U&&"[object WeakMap]"!=te(new U))&&(te=function(e){var t=u(e),r="[object Object]"==t?e.constructor:void 0,n=r?w(r):"";if(n)switch(n){case Q:return"[object DataView]";case X:return"[object Map]";case Y:return"[object Promise]";case Z:return"[object Set]";case ee:return"[object WeakMap]"}return t});var re=te,ne=Object.prototype.hasOwnProperty;var oe=/\w*$/;var ae=s?s.prototype:void 0,ce=ae?ae.valueOf:void 0;function ue(e,t,r){var n,o,a,c=e.constructor;switch(t){case"[object ArrayBuffer]":return O(e);case"[object Boolean]":case"[object Date]":return new c(+e);case"[object DataView]":return function(e,t){var r=t?O(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return S(e,r);case"[object Map]":return new c;case"[object Number]":case"[object String]":return new c(e);case"[object RegExp]":return(a=new(o=e).constructor(o.source,oe.exec(o))).lastIndex=o.lastIndex,a;case"[object Set]":return new c;case"[object Symbol]":return n=e,ce?Object(ce.call(n)):{}}}var se=I&&I.isMap,ie=se?M(se):function(e){return i(e)&&"[object Map]"==re(e)};var le=I&&I.isSet,be=le?M(le):function(e){return i(e)&&"[object Set]"==re(e)},fe={};function je(e,t,r,n,o,a){var c,u=1&t,s=2&t,i=4&t;if(r&&(c=o?r(e,n,o,a):r(e)),void 0!==c)return c;if(!l(e))return e;var b=g(e);if(b){if(c=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&ne.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(e),!u)return P(e,c)}else{var f=re(e),j="[object Function]"==f||"[object GeneratorFunction]"==f;if(D(e))return E(e,u);if("[object Object]"==f||"[object Arguments]"==f||j&&!o){if(c=s||j?{}:x(e),!u)return s?function(e,t){return m(e,N(e),t)}(e,function(e,t){return e&&m(t,d(t),e)}(c,e)):function(e,t){return m(e,H(e),t)}(e,function(e,t){return e&&m(t,V(t),e)}(c,e))}else{if(!fe[f])return o?e:{};c=ue(e,f,u)}}a||(a=new F);var v=a.get(e);if(v)return v;a.set(e,c),be(e)?e.forEach((function(n){c.add(je(n,t,r,n,e,a))})):ie(e)&&e.forEach((function(n,o){c.set(o,je(n,t,r,o,e,a))}));var p=i?s?_:$:s?keysIn:V,y=b?void 0:p(e);return function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););}(y||e,(function(n,o){y&&(n=e[o=n]),k(c,o,je(n,t,r,o,e,a))})),c}fe["[object Arguments]"]=fe["[object Array]"]=fe["[object ArrayBuffer]"]=fe["[object DataView]"]=fe["[object Boolean]"]=fe["[object Date]"]=fe["[object Float32Array]"]=fe["[object Float64Array]"]=fe["[object Int8Array]"]=fe["[object Int16Array]"]=fe["[object Int32Array]"]=fe["[object Map]"]=fe["[object Number]"]=fe["[object Object]"]=fe["[object RegExp]"]=fe["[object Set]"]=fe["[object String]"]=fe["[object Symbol]"]=fe["[object Uint8Array]"]=fe["[object Uint8ClampedArray]"]=fe["[object Uint16Array]"]=fe["[object Uint32Array]"]=!0,fe["[object Error]"]=fe["[object Function]"]=fe["[object WeakMap]"]=!1;function ve(e){return je(e,5)}const pe={formatResult:e=>e,requestMethod:function(e){let t,r;return"string"==typeof e?t=e:(t=e.url,r=e),fetch(t,r).then((e=>{if(e.ok)return e.json();throw new Error(e.statusText)}))},manual:!1,onSuccess:()=>{},onError:()=>{},onFinally:()=>{},defaultLoading:!1,loadingDelay:0,pollingInterval:0,pollingWhenHidden:!0,pollingSinceLastFinished:!0,defaultParams:[],debounceInterval:0,loadingWhenDebounceStart:!0,throttleInterval:0,initialData:void 0,throwOnError:!1},ye=Symbol("useRequestConfig");function me(c,u={}){var s;let i={};t()&&(i=null!=(s=r(ye))?s:{});const l=e(e(e({},pe),i),u),{requestMethod:f,defaultLoading:j,manual:v,throwOnError:p,onSuccess:y,onError:m,onFinally:d,formatResult:h,initialData:g,defaultParams:w,loadingDelay:A,debounceInterval:O,loadingWhenDebounceStart:S,throttleInterval:I,pollingInterval:M,pollingWhenHidden:P,pollingSinceLastFinished:D}=l;let E;E=["string","object"].includes(typeof c)?()=>f(c):(...e)=>new Promise(((t,r)=>{const n=c(...e);let o=n;if(!n.then){if(!["string","object"].includes(typeof n))throw new Error("If sevice is a function, it must return a String, Object or Promise");o=f(n)}o.then(t).catch(r)}));const x=n(j),F=n(g),k=n(),U=n(w),W=n(w);let R=0,V=!1;t()&&o((()=>{V=!0}));let B,L,q=n(!0);function C(...e){L&&clearTimeout(L),B&&clearTimeout(B),A?B=setTimeout((()=>{x.value=!0}),A):x.value=!0,R++;const t=R;U.value=ve(e);const r=()=>V||t!==R;return E(...e).then((t=>{if(r())return;const n=h(t);return F.value=n,W.value=ve(e),y(n,e),n})).catch((t=>{if(!r()&&(console.error(t),k.value=t,m(t,e),p))throw t})).finally((()=>{r()||(B&&clearTimeout(B),M&&D&&(L=P&&!q.value?setInterval((()=>{P&&!q.value||(clearInterval(L),C(...e))}),M):setTimeout((()=>{C(...e)}),M)),x.value=!1,d())}))}t()&&(q=a().isVisible);let H,N=C;if(O){const e=b(C,O);N=(...t)=>(S&&(x.value=!0),Promise.resolve(e(...t)))}if(I){const e=T(C,I);N=(...t)=>Promise.resolve(e(...t))}return M&&!D&&(N=(...e)=>(H&&clearInterval(H),H=setInterval((()=>{P&&!q.value||C(...e)}),M),C(...e))),v||N(...w),{loading:x,error:k,data:F,run:N,params:U,lastSuccessParams:W,cancel:()=>{H&&clearInterval(H),L&&clearTimeout(L),B&&clearTimeout(B),R++,x.value=!1},refresh:function(){return N(...U.value)}}}export{ye as R,me as u};
